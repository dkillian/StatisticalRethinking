<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-01-05">

<title>Statistical Rethinking 2024</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="rethinking2024wk1_files/libs/clipboard/clipboard.min.js"></script>
<script src="rethinking2024wk1_files/libs/quarto-html/quarto.js"></script>
<script src="rethinking2024wk1_files/libs/quarto-html/popper.min.js"></script>
<script src="rethinking2024wk1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="rethinking2024wk1_files/libs/quarto-html/anchor.min.js"></script>
<link href="rethinking2024wk1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="rethinking2024wk1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="rethinking2024wk1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="rethinking2024wk1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="rethinking2024wk1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="rethinking2024wk1_files/libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="rethinking2024wk1_files/libs/tabwid-1.1.3/tabwid.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#difference-between-bayesian-and-frequentist" id="toc-difference-between-bayesian-and-frequentist" class="nav-link active" data-scroll-target="#difference-between-bayesian-and-frequentist">Difference between Bayesian and frequentist</a></li>
  <li><a href="#bayes-rule" id="toc-bayes-rule" class="nav-link" data-scroll-target="#bayes-rule">Bayes Rule</a>
  <ul>
  <li><a href="#bayes-rule-as-an-analytical-tool" id="toc-bayes-rule-as-an-analytical-tool" class="nav-link" data-scroll-target="#bayes-rule-as-an-analytical-tool">Bayes’ Rule as an analytical tool</a></li>
  </ul></li>
  <li><a href="#inference-for-a-proportion" id="toc-inference-for-a-proportion" class="nav-link" data-scroll-target="#inference-for-a-proportion">Inference for a proportion</a>
  <ul>
  <li><a href="#frequentist" id="toc-frequentist" class="nav-link" data-scroll-target="#frequentist">Frequentist</a></li>
  <li><a href="#bayesian" id="toc-bayesian" class="nav-link" data-scroll-target="#bayesian">Bayesian</a>
  <ul class="collapse">
  <li><a href="#likelihood" id="toc-likelihood" class="nav-link" data-scroll-target="#likelihood">Likelihood</a></li>
  <li><a href="#priors" id="toc-priors" class="nav-link" data-scroll-target="#priors">Priors</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#enumerating-sequences-of-events" id="toc-enumerating-sequences-of-events" class="nav-link" data-scroll-target="#enumerating-sequences-of-events">Enumerating sequences of events</a>
  <ul>
  <li><a href="#the-counting-rule" id="toc-the-counting-rule" class="nav-link" data-scroll-target="#the-counting-rule">The counting rule</a></li>
  <li><a href="#permutations" id="toc-permutations" class="nav-link" data-scroll-target="#permutations">Permutations</a>
  <ul class="collapse">
  <li><a href="#permutation-with-duplicates" id="toc-permutation-with-duplicates" class="nav-link" data-scroll-target="#permutation-with-duplicates">Permutation with duplicates</a></li>
  <li><a href="#permuted-groups" id="toc-permuted-groups" class="nav-link" data-scroll-target="#permuted-groups">Permuted groups</a></li>
  </ul></li>
  <li><a href="#combinations" id="toc-combinations" class="nav-link" data-scroll-target="#combinations">Combinations</a></li>
  <li><a href="#randomization-inference" id="toc-randomization-inference" class="nav-link" data-scroll-target="#randomization-inference">Randomization inference</a></li>
  </ul></li>
  <li><a href="#homework" id="toc-homework" class="nav-link" data-scroll-target="#homework">Homework</a></li>
  </ul>
</nav>
</div>
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Statistical Rethinking 2024</h1>
<p class="subtitle lead">Week 1 lecture notes</p>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 5, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="difference-between-bayesian-and-frequentist" class="level2">
<h2 class="anchored" data-anchor-id="difference-between-bayesian-and-frequentist">Difference between Bayesian and frequentist</h2>
<p>The frequentist approach to inference:</p>
<p><span class="math inline">\(P(data|model)\)</span></p>
<p>The Bayesian approach to inference:</p>
<p><span class="math inline">\(P(model|data)\)</span></p>
<p>What are each of these expressions saying?</p>
<p>How would you summarize the different approaches narratively?</p>
<p>What estimation approach is used both by the frequentists and the Bayesians?</p>
</section>
<section id="bayes-rule" class="level2">
<h2 class="anchored" data-anchor-id="bayes-rule">Bayes Rule</h2>
<p>Let’s derive the Bayes’ Rule, drawing primarily from <a href="https://oscarbonilla.com/2009/05/visualizing-bayes-theorem/">Oscar Bonilla</a>.</p>
<p>Consider two overlapping events A and B occurring within a universe U.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">include_graphics</span>(<span class="st">"venn-last.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="venn-last.png" class="img-fluid" width="195"></p>
</div>
</div>
<p>Let’s agree that the probability of something is how often it occurs. So in the Venn diagram above:</p>
<p><span class="math inline">\(P(A)=\frac{A}{U}\)</span></p>
<p><span class="math inline">\(P(AB)=\frac{AB}{U}\)</span></p>
<p>What if we shifted our question to ask, how much of A is in B? Our new universe is now B, and we’re interested in the overlap of A and B as a proportion of B. In the language of probability, for “how much of A is in B” we say “what is the probability of A, given B?” In notation, we write that as <span class="math inline">\(A|B\)</span>. This gives us:</p>
<p><span class="math inline">\(P(A|B)=\frac{P(AB)}{P(B)}\)</span></p>
<p>Let’s solve for <span class="math inline">\(P(AB)\)</span>:</p>
<p><span class="math inline">\(P(AB)=P(A|B)P(B)\)</span></p>
<p>Now let’s ask, how much of B is in A? In probability language, what is the probability of B, given A?</p>
<p><span class="math inline">\(P(B|A)=\frac{P(AB)}{P(A)}\)</span></p>
<p>Solve for <span class="math inline">\(P(AB)\)</span>:</p>
<p><span class="math inline">\(P(AB)=P(B|A)P(A)\)</span></p>
<p>The joint probability of A and B is the same whether you are asking about the proportion of A in B, or the proportion of B in A. Now as a simple algebraic trick, put the two identities together and solve for <span class="math inline">\(A|B\)</span>:</p>
<p><span class="math inline">\(P(A|B)P(B)=P(B|A)P(A)\)</span></p>
<p><span class="math inline">\(P(A|B)=\frac{P(B|A)P(A)}{P(B)}\)</span></p>
<p>And that’s it. That’s Bayes’ Rule.</p>
<section id="bayes-rule-as-an-analytical-tool" class="level3">
<h3 class="anchored" data-anchor-id="bayes-rule-as-an-analytical-tool">Bayes’ Rule as an analytical tool</h3>
<p>Now let’s interpret Bayes’ Rule in terms of a data analysis. We want to estimate the probability of a hypothesized cause, given its observed effect. The hypothesized cause is our model of what’s happening. The observed effect is the set of data that we have collected.</p>
<p><span class="math inline">\(P(model|data)=\frac{P(data|model)P(model)}{P(data)}\)</span></p>
<p>To express this narratively, we might say that we have some observed data and we want to estimate the probability of various causes of what we observed. That’s <span class="math inline">\(P(model|data)\)</span>. We look at our data and ask, how often would we see such data, if one of our hypothesized causes were true? That’s <span class="math inline">\(P(data|model)\)</span>, and is referred to as the <em>likelihood</em> of a proposed model, given the observed data. The likelihood of a proposed model given the observed data is scaled by how often that hypothesized cause occurs (<span class="math inline">\(P(model)\)</span>). Note that <span class="math inline">\(P(model)\)</span> incorporates information that is outside of our statistical framework. We call <span class="math inline">\(P(model)\)</span> our <em>prior probability</em>. We multiply the likelihood of a model (given the observed data) by the overall incidence of that model (<span class="math inline">\(P(model)\)</span>, our prior).</p>
<p>We then normalize the numerator of the expression to a probability. That normalizing constant is <span class="math inline">\(P(data)\)</span> and doesn’t really have a substantive interpretation other than to say it’s the average probability of your data which has the effect of converting your output into a probability.</p>
<p>Practice:</p>
<p>Consider the following table:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>cp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">1000</span>,<span class="dv">1500</span>,<span class="dv">2000</span>),</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y10=</span><span class="fu">c</span>(.<span class="dv">802</span>,.<span class="dv">687</span>, .<span class="dv">456</span>),</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y20=</span><span class="fu">c</span>(.<span class="dv">103</span>, .<span class="dv">172</span>, .<span class="dv">312</span>),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y30=</span><span class="fu">c</span>(.<span class="dv">034</span>,.<span class="dv">071</span>, .<span class="dv">124</span>),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y40=</span><span class="fu">c</span>(.<span class="dv">06</span>,.<span class="dv">071</span>,.<span class="dv">108</span>),</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">p_x=</span><span class="fu">c</span>(.<span class="dv">116</span>, .<span class="dv">099</span>, .<span class="dv">785</span>))</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(cp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-375217c8{}.cl-37472ffc{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-374be132{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-374bfe42{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-374bfe4c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-374bfe56{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-375217c8"><thead><tr style="overflow-wrap:break-word;"><th class="cl-374bfe42"><p class="cl-374be132"><span class="cl-37472ffc">x</span></p></th><th class="cl-374bfe42"><p class="cl-374be132"><span class="cl-37472ffc">y10</span></p></th><th class="cl-374bfe42"><p class="cl-374be132"><span class="cl-37472ffc">y20</span></p></th><th class="cl-374bfe42"><p class="cl-374be132"><span class="cl-37472ffc">y30</span></p></th><th class="cl-374bfe42"><p class="cl-374be132"><span class="cl-37472ffc">y40</span></p></th><th class="cl-374bfe42"><p class="cl-374be132"><span class="cl-37472ffc">p_x</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-374bfe4c"><p class="cl-374be132"><span class="cl-37472ffc">1,000</span></p></td><td class="cl-374bfe4c"><p class="cl-374be132"><span class="cl-37472ffc">0.802</span></p></td><td class="cl-374bfe4c"><p class="cl-374be132"><span class="cl-37472ffc">0.103</span></p></td><td class="cl-374bfe4c"><p class="cl-374be132"><span class="cl-37472ffc">0.034</span></p></td><td class="cl-374bfe4c"><p class="cl-374be132"><span class="cl-37472ffc">0.060</span></p></td><td class="cl-374bfe4c"><p class="cl-374be132"><span class="cl-37472ffc">0.116</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-374bfe4c"><p class="cl-374be132"><span class="cl-37472ffc">1,500</span></p></td><td class="cl-374bfe4c"><p class="cl-374be132"><span class="cl-37472ffc">0.687</span></p></td><td class="cl-374bfe4c"><p class="cl-374be132"><span class="cl-37472ffc">0.172</span></p></td><td class="cl-374bfe4c"><p class="cl-374be132"><span class="cl-37472ffc">0.071</span></p></td><td class="cl-374bfe4c"><p class="cl-374be132"><span class="cl-37472ffc">0.071</span></p></td><td class="cl-374bfe4c"><p class="cl-374be132"><span class="cl-37472ffc">0.099</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-374bfe56"><p class="cl-374be132"><span class="cl-37472ffc">2,000</span></p></td><td class="cl-374bfe56"><p class="cl-374be132"><span class="cl-37472ffc">0.456</span></p></td><td class="cl-374bfe56"><p class="cl-374be132"><span class="cl-37472ffc">0.312</span></p></td><td class="cl-374bfe56"><p class="cl-374be132"><span class="cl-37472ffc">0.124</span></p></td><td class="cl-374bfe56"><p class="cl-374be132"><span class="cl-37472ffc">0.108</span></p></td><td class="cl-374bfe56"><p class="cl-374be132"><span class="cl-37472ffc">0.785</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>The variable X takes on the values 1000, 1500, 2000</p>
<p>The variable Y takes on the values 10, 20, 30, 40</p>
<p>Of all elements with x=1000, 80 percent have a y value of 10. In probability notation:</p>
<p><span class="math inline">\(P(y=10|x=1000)=80.2\%\)</span></p>
<p>Note that this is a specific instantiation of <span class="math inline">\(P(Y|X)\)</span>, where X and Y take on specific values. What expression did we derive for <span class="math inline">\(P(Y|X)\)</span>?</p>
<p>Units with x=1000 make up 11.6 percent of the sample. <span class="math inline">\(P(x=1000)=11.6\%\)</span></p>
<p>Based on this information, what proportion of the total sample has an x value 1000 and y value of 10?</p>
<p>In probability language, this is the joint probability of X and Y, which is <span class="math inline">\(P(XY)\)</span> or, more formally, <span class="math inline">\(P(X\cap Y)\)</span>. What expression did we derive for <span class="math inline">\(P(XY)\)</span>?</p>
<p>Using the expression for <span class="math inline">\(P(XY)\)</span> and information in the table provided above, do the following calculations:</p>
<p><span class="math inline">\(P(x=1000 \cap y=40)\)</span></p>
<p><span class="math inline">\(P(x=2000\cap y=20)\)</span></p>
<p><span class="math inline">\(P(x=1500\cap y=30)\)</span></p>
<p>Now consider another table:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>bp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">1000</span>,<span class="dv">1500</span>,<span class="dv">2000</span>, <span class="st">"p_y"</span>),</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"y:10"</span><span class="ot">=</span><span class="fu">c</span>(.<span class="dv">093</span>, .<span class="dv">068</span>, .<span class="dv">358</span>, .<span class="dv">519</span>),</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">`</span><span class="at">y:20</span><span class="st">`</span><span class="ot">=</span><span class="fu">c</span>(.<span class="dv">012</span>, .<span class="dv">017</span>, .<span class="dv">245</span>, .<span class="dv">274</span>),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                 <span class="st">`</span><span class="at">y:30</span><span class="st">`</span><span class="ot">=</span><span class="fu">c</span>(.<span class="dv">004</span>, .<span class="dv">007</span>, .<span class="dv">097</span>, .<span class="dv">108</span>),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                 <span class="st">`</span><span class="at">y:40</span><span class="st">`</span><span class="ot">=</span><span class="fu">c</span>(.<span class="dv">007</span>, .<span class="dv">007</span>, .<span class="dv">085</span>, .<span class="dv">099</span>),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>                 <span class="st">`</span><span class="at">p_x</span><span class="st">`</span><span class="ot">=</span><span class="fu">c</span>(.<span class="dv">116</span>, .<span class="dv">099</span>, .<span class="dv">785</span>, <span class="cn">NA</span>))</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>bp <span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-37ce23ea{}.cl-37c4d600{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-37c87b8e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-37c87b98{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-37c88e80{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-37c88e8a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-37c88e8b{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-37c88e94{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-37c88e9e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-37c88e9f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-37ce23ea"><thead><tr style="overflow-wrap:break-word;"><th class="cl-37c88e80"><p class="cl-37c87b8e"><span class="cl-37c4d600">x</span></p></th><th class="cl-37c88e8a"><p class="cl-37c87b98"><span class="cl-37c4d600">y.10</span></p></th><th class="cl-37c88e8a"><p class="cl-37c87b98"><span class="cl-37c4d600">y.20</span></p></th><th class="cl-37c88e8a"><p class="cl-37c87b98"><span class="cl-37c4d600">y.30</span></p></th><th class="cl-37c88e8a"><p class="cl-37c87b98"><span class="cl-37c4d600">y.40</span></p></th><th class="cl-37c88e8a"><p class="cl-37c87b98"><span class="cl-37c4d600">p_x</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-37c88e8b"><p class="cl-37c87b8e"><span class="cl-37c4d600">1000</span></p></td><td class="cl-37c88e94"><p class="cl-37c87b98"><span class="cl-37c4d600">0.093</span></p></td><td class="cl-37c88e94"><p class="cl-37c87b98"><span class="cl-37c4d600">0.012</span></p></td><td class="cl-37c88e94"><p class="cl-37c87b98"><span class="cl-37c4d600">0.004</span></p></td><td class="cl-37c88e94"><p class="cl-37c87b98"><span class="cl-37c4d600">0.007</span></p></td><td class="cl-37c88e94"><p class="cl-37c87b98"><span class="cl-37c4d600">0.116</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-37c88e8b"><p class="cl-37c87b8e"><span class="cl-37c4d600">1500</span></p></td><td class="cl-37c88e94"><p class="cl-37c87b98"><span class="cl-37c4d600">0.068</span></p></td><td class="cl-37c88e94"><p class="cl-37c87b98"><span class="cl-37c4d600">0.017</span></p></td><td class="cl-37c88e94"><p class="cl-37c87b98"><span class="cl-37c4d600">0.007</span></p></td><td class="cl-37c88e94"><p class="cl-37c87b98"><span class="cl-37c4d600">0.007</span></p></td><td class="cl-37c88e94"><p class="cl-37c87b98"><span class="cl-37c4d600">0.099</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-37c88e8b"><p class="cl-37c87b8e"><span class="cl-37c4d600">2000</span></p></td><td class="cl-37c88e94"><p class="cl-37c87b98"><span class="cl-37c4d600">0.358</span></p></td><td class="cl-37c88e94"><p class="cl-37c87b98"><span class="cl-37c4d600">0.245</span></p></td><td class="cl-37c88e94"><p class="cl-37c87b98"><span class="cl-37c4d600">0.097</span></p></td><td class="cl-37c88e94"><p class="cl-37c87b98"><span class="cl-37c4d600">0.085</span></p></td><td class="cl-37c88e94"><p class="cl-37c87b98"><span class="cl-37c4d600">0.785</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-37c88e9e"><p class="cl-37c87b8e"><span class="cl-37c4d600">p_y</span></p></td><td class="cl-37c88e9f"><p class="cl-37c87b98"><span class="cl-37c4d600">0.519</span></p></td><td class="cl-37c88e9f"><p class="cl-37c87b98"><span class="cl-37c4d600">0.274</span></p></td><td class="cl-37c88e9f"><p class="cl-37c87b98"><span class="cl-37c4d600">0.108</span></p></td><td class="cl-37c88e9f"><p class="cl-37c87b98"><span class="cl-37c4d600">0.099</span></p></td><td class="cl-37c88e9f"><p class="cl-37c87b98"><span class="cl-37c4d600"></span></p></td></tr></tbody></table></div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(bp[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(bp[<span class="dv">4</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(bp[,<span class="dv">6</span>], <span class="at">na.rm=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<p>The probability of x=1000 and y=20 is 1.2 percent. <span class="math inline">\(P(y=20\cap x=1000)=1.2\%\)</span></p>
<p>Among units with x=1000, what proportion have y=20? As mentioned above, this is a specific instantiation of <span class="math inline">\(P(Y|X)\)</span></p>
<p>Using the expression for <span class="math inline">\(P(Y|X)\)</span> and information in the table above, do the following calculations:</p>
<p><span class="math inline">\(P(y=20|x=1000)\)</span></p>
<p><span class="math inline">\(P(y=40|x=2000)\)</span></p>
<p><span class="math inline">\(P(y=10|x=1500)\)</span></p>
</section>
</section>
<section id="inference-for-a-proportion" class="level2">
<h2 class="anchored" data-anchor-id="inference-for-a-proportion">Inference for a proportion</h2>
<p>Consider a randomly assigned treatment to 20 subjects, and 20 subjects without the treatment</p>
<p>The treatment is expected to reduce the probability of an event. The 40 subjects are observed for a given period of time, and the incidence of events is observed for each group.</p>
<p>For any events that occur during this period, what is the probability <em>p</em> that the event occurred within the treatment group?</p>
<p><em>p</em> = probability of the event originating from the treatment group</p>
<p><span class="math inline">\(H_0: p=50\%\)</span> The event is equally likely to have occurred in the treatment or control group, signifying no treatment effect</p>
<p><span class="math inline">\(H_1: p \lt 50\%\)</span> The event is equally likely to have occurred in the treatment or control group, signifying no treatment effect</p>
<p>Alternative hypothesis: p&lt;50%. The event is less likely to have come from the treatment group than the control group, signifying a treatment effect</p>
<p>For the period under observation, there were 20 events - 4 events in the treatment group and 16 events in the control group.</p>
<p>How likely are these four events to have occurred within the treatment group?</p>
<section id="frequentist" class="level3">
<h3 class="anchored" data-anchor-id="frequentist">Frequentist</h3>
<p>We may consider the twenty events as the number of trials, and the four events in the treatment group as the number of ‘successes’ of these 20 trials.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="at">x=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, <span class="co"># we consider the probabilities for all possibilities up to four </span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">size=</span><span class="dv">20</span>, </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">prob=</span>.<span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.00591</code></pre>
</div>
</div>
<p>The probability of observing four or fewer pregnancies, under an assumption of no treatment effect (the null hypothesis), is .0059.</p>
<p>The probability is less than 5%. By convention, we reject the null hypothesis and consider this ‘failure to reject’ to be a piece of evidence in support of the alternative hypothesis.</p>
</section>
<section id="bayesian" class="level3">
<h3 class="anchored" data-anchor-id="bayesian">Bayesian</h3>
<p>Recall Bayes’ Rule:</p>
<p><span class="math inline">\(P(model|data)=\frac{P(data|model)P(model)}{P(data)}\)</span></p>
<p>Recall that Bayes’ Rule gives us the probability of a hypothesis (model) given the observed data - that’s <span class="math inline">\(P(model|data)\)</span></p>
<p>We refer to <span class="math inline">\(P(data|model)\)</span> as the <em>likelihood</em> of our data for a given hypothesized model.</p>
<p>We refer to <span class="math inline">\(P(model)\)</span> as our prior - what we think is the probability of the model absent any observed data.</p>
<p>Finally, <span class="math inline">\(P(data)\)</span> has no substantive interpretation, it’s just a normalizing constant</p>
<p>Under a Bayesian framework, the null hypothesis remains the same, but we search the model space for the most likely value given the observed data.</p>
<p>What would be a sensible range of plausible values? Let’s say that the range of possible probabilities would be 10% to 90%. So we’ll set our model space:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span>.<span class="dv">1</span>,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">to=</span>.<span class="dv">9</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">by=</span>.<span class="dv">1</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9</code></pre>
</div>
</div>
<section id="likelihood" class="level4">
<h4 class="anchored" data-anchor-id="likelihood">Likelihood</h4>
<p>Now that we have our model space and observed data, we can calculate the likelihoods. We ask how often our observed data occur for each of our candidate models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits=</span><span class="dv">3</span>, <span class="at">scipen=</span><span class="dv">10</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>likelihood <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="at">x=</span><span class="dv">4</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">size=</span><span class="dv">20</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prob=</span>p)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>likelihood <span class="sc">%&gt;%</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0898 0.2182 0.1304 0.0350 0.0046 0.0003 0.0000 0.0000 0.0000</code></pre>
</div>
</div>
</section>
<section id="priors" class="level4">
<h4 class="anchored" data-anchor-id="priors">Priors</h4>
<p>After we set our model space, we need to establish our priors</p>
<p>For each of the possible models, which ones do we think are more likely to be true?</p>
<p>Well, we don’t know if the treatment works, so we should probably put the most weight on our null hypothesis of no effect. In this specific setup, a null hypothesis of no treatment effect is 50% - the event could just as easily have occurred in the treatment group as in the control group.</p>
<p>Now let’s suppose that there may be some small chance that the treatment has the desired effect. Let’s also suppose that there may be some small chance that the treatment has the opposite effect of what it is intended to do. We might think a positive treatment effect is more likely than a negative treatment effect. But to be fully agnostic and honest about our experiment, we will weight both scenarios equally.</p>
<p>Putting most weight on the null hypothesis of 50% and small weight equally distributed on the possibility of a positive or negative treatment effect, might look like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(.<span class="dv">06</span>,<span class="dv">4</span>), .<span class="dv">52</span>, <span class="fu">rep</span>(.<span class="dv">06</span>,<span class="dv">4</span>))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>prior</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.06 0.06 0.06 0.06 0.52 0.06 0.06 0.06 0.06</code></pre>
</div>
</div>
<p>Narratively, we might express our priors as saying that we are inclined to believe that there is no treatment effect, but we are willing to entertain the possibility that the treatment may have a positive or negative effect.</p>
<p>We are now ready to calculate the numerator in Bayes’ Rule. We simply multiply the likelihood by its corresponding prior.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>numerator <span class="ot">&lt;-</span> likelihood<span class="sc">*</span>prior</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>numerator <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.005 0.013 0.008 0.002 0.002 0.000 0.000 0.000 0.000</code></pre>
</div>
</div>
<p>The last step is to normalize our numerator values into a set of probabilities.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>denominator <span class="ot">&lt;-</span> <span class="fu">sum</span>(numerator)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> numerator <span class="sc">/</span> denominator</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>posterior <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1748 0.4248 0.2539 0.0681 0.0780 0.0005 0.0000 0.0000 0.0000</code></pre>
</div>
</div>
<p>Let’s put all this together in a summary table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(p, likelihood, prior, numerator, posterior) <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">3</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-38205ec6{}.cl-3816c910{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-381a8a50{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-381aa0bc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-381aa0d0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-381aa0d1{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-38205ec6"><thead><tr style="overflow-wrap:break-word;"><th class="cl-381aa0bc"><p class="cl-381a8a50"><span class="cl-3816c910">p</span></p></th><th class="cl-381aa0bc"><p class="cl-381a8a50"><span class="cl-3816c910">likelihood</span></p></th><th class="cl-381aa0bc"><p class="cl-381a8a50"><span class="cl-3816c910">prior</span></p></th><th class="cl-381aa0bc"><p class="cl-381a8a50"><span class="cl-3816c910">numerator</span></p></th><th class="cl-381aa0bc"><p class="cl-381a8a50"><span class="cl-3816c910">posterior</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.1</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.090</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.06</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.005</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.175</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.2</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.218</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.06</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.013</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.425</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.3</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.130</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.06</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.008</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.254</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.4</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.035</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.06</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.002</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.068</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.5</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.005</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.52</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.002</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.078</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.6</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.000</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.06</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.000</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.7</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.000</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.06</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.000</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.8</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.000</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.06</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.000</span></p></td><td class="cl-381aa0d0"><p class="cl-381a8a50"><span class="cl-3816c910">0.000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-381aa0d1"><p class="cl-381a8a50"><span class="cl-3816c910">0.9</span></p></td><td class="cl-381aa0d1"><p class="cl-381a8a50"><span class="cl-3816c910">0.000</span></p></td><td class="cl-381aa0d1"><p class="cl-381a8a50"><span class="cl-3816c910">0.06</span></p></td><td class="cl-381aa0d1"><p class="cl-381a8a50"><span class="cl-3816c910">0.000</span></p></td><td class="cl-381aa0d1"><p class="cl-381a8a50"><span class="cl-3816c910">0.000</span></p></td></tr></tbody></table></div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(out, <span class="fu">aes</span>(<span class="at">x=</span>p)) <span class="sc">+</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">y=</span>posterior),</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">width=</span>.<span class="dv">05</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">color=</span><span class="st">"blue"</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill=</span><span class="st">"dodgerblue2"</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha=</span>.<span class="dv">6</span>) <span class="sc">+</span> </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">y=</span>prior),</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">width=</span>.<span class="dv">05</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">color=</span><span class="st">"green"</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill=</span><span class="st">"lightgreen"</span>,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha=</span>.<span class="dv">6</span>) <span class="sc">+</span> </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(.<span class="dv">1</span>,.<span class="dv">9</span>,.<span class="dv">1</span>),</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">percent_format</span>(<span class="at">accuracy=</span><span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">55</span>),</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,.<span class="dv">55</span>,.<span class="dv">05</span>),</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">percent_format</span>(<span class="at">accuracy=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Candidate model value"</span>,</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Probability"</span>,</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Probability of candidate model values&lt;br&gt;</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="st">       &lt;span style='color:#1c86ee;'&gt;Posterior distribution&lt;/span&gt;</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="st">       &lt;span style='color:#90ee90;'&gt;Prior distribution&lt;/span&gt;"</span>) <span class="sc">+</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">0</span>, <span class="at">vjust=</span>.<span class="dv">55</span>),</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title=</span><span class="fu">element_markdown</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="rethinking2024wk1_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="enumerating-sequences-of-events" class="level2">
<h2 class="anchored" data-anchor-id="enumerating-sequences-of-events">Enumerating sequences of events</h2>
<section id="the-counting-rule" class="level3">
<h3 class="anchored" data-anchor-id="the-counting-rule">The counting rule</h3>
<p>This is just to get our thinking started, because it’s nothing other than counting. If event A could occur three different ways, and event B could occur two different ways, then the total number of ways events A and B can occur together is 3x2=6.</p>
<p>This principle generalizes to <em>m x n</em> ways for events A and B to co-occur. This principle holds for sequential events as well. For both cases, the events must be independent and not change in any way across the course of the calculations.</p>
</section>
<section id="permutations" class="level3">
<h3 class="anchored" data-anchor-id="permutations">Permutations</h3>
<p>A permutation is a rearrangement of the order of a sequence. Consider the letters <em>a, b, c, d</em>. How many different ways can they be ordered?</p>
<p>We can brute force this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>per <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"permutation practice.xlsx"</span>,</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sheet=</span><span class="st">"permutations"</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(per)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-38bcc5cc{}.cl-38b3537a{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-38b71e74{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-38b73148{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-38b73152{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-38b7315c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-38bcc5cc"><thead><tr style="overflow-wrap:break-word;"><th class="cl-38b73148"><p class="cl-38b71e74"><span class="cl-38b3537a">A</span></p></th><th class="cl-38b73148"><p class="cl-38b71e74"><span class="cl-38b3537a">B</span></p></th><th class="cl-38b73148"><p class="cl-38b71e74"><span class="cl-38b3537a">C</span></p></th><th class="cl-38b73148"><p class="cl-38b71e74"><span class="cl-38b3537a">D</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-38b73152"><p class="cl-38b71e74"><span class="cl-38b3537a">abcd</span></p></td><td class="cl-38b73152"><p class="cl-38b71e74"><span class="cl-38b3537a">bacd</span></p></td><td class="cl-38b73152"><p class="cl-38b71e74"><span class="cl-38b3537a">cabd</span></p></td><td class="cl-38b73152"><p class="cl-38b71e74"><span class="cl-38b3537a">dabc</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-38b73152"><p class="cl-38b71e74"><span class="cl-38b3537a">abdc</span></p></td><td class="cl-38b73152"><p class="cl-38b71e74"><span class="cl-38b3537a">badc</span></p></td><td class="cl-38b73152"><p class="cl-38b71e74"><span class="cl-38b3537a">cadb</span></p></td><td class="cl-38b73152"><p class="cl-38b71e74"><span class="cl-38b3537a">dacb</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-38b73152"><p class="cl-38b71e74"><span class="cl-38b3537a">acbd</span></p></td><td class="cl-38b73152"><p class="cl-38b71e74"><span class="cl-38b3537a">bcad</span></p></td><td class="cl-38b73152"><p class="cl-38b71e74"><span class="cl-38b3537a">cbad</span></p></td><td class="cl-38b73152"><p class="cl-38b71e74"><span class="cl-38b3537a">dbac</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-38b73152"><p class="cl-38b71e74"><span class="cl-38b3537a">acdb</span></p></td><td class="cl-38b73152"><p class="cl-38b71e74"><span class="cl-38b3537a">bcda</span></p></td><td class="cl-38b73152"><p class="cl-38b71e74"><span class="cl-38b3537a">cbda</span></p></td><td class="cl-38b73152"><p class="cl-38b71e74"><span class="cl-38b3537a">dbca</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-38b73152"><p class="cl-38b71e74"><span class="cl-38b3537a">adbc</span></p></td><td class="cl-38b73152"><p class="cl-38b71e74"><span class="cl-38b3537a">bdac</span></p></td><td class="cl-38b73152"><p class="cl-38b71e74"><span class="cl-38b3537a">cdab</span></p></td><td class="cl-38b73152"><p class="cl-38b71e74"><span class="cl-38b3537a">dcab</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-38b7315c"><p class="cl-38b71e74"><span class="cl-38b3537a">adcb</span></p></td><td class="cl-38b7315c"><p class="cl-38b71e74"><span class="cl-38b3537a">bdca</span></p></td><td class="cl-38b7315c"><p class="cl-38b71e74"><span class="cl-38b3537a">cdba</span></p></td><td class="cl-38b7315c"><p class="cl-38b71e74"><span class="cl-38b3537a">dcba</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Each of the four starting letters has six possible orderings.</p>
<p>4x6=24</p>
<p>Another derivation would be to note that there are four possible selections of the first letter. After the first letter has been selected, three possible letters remain. After the first two letters are selected, two letters remain. After three letters have been selected, there is only one letter left.</p>
<p>By the counting rule, the number of possible orderings is 4x3x2x1 = 24</p>
<p>Note that this is <em>n(n-1)(n-2)… = n!</em></p>
<p>4! = 24</p>
<section id="permutation-with-duplicates" class="level4">
<h4 class="anchored" data-anchor-id="permutation-with-duplicates">Permutation with duplicates</h4>
<p>What if there is repetition in the orderings? How many different ordered arrangements are possible with the sequence s, e, l, l?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">here</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "C:/Users/dan.killian/Documents/StatisticalRethinking"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">include_graphics</span>(<span class="st">"perms with dupes.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="perms%20with%20dupes.png" class="img-fluid" width="272"></p>
</div>
</div>
<p>There are 4! = 24 different permutations, if the items were unique</p>
<p>There are 2! = 2 repeating letter combinations</p>
<p>The unique orderings are <em>4! / 2! = 12</em></p>
<p>Another example: How many different letter arrangements can be formed from the letters P E P P E R ?</p>
<p>There are <em>6! = 720</em> permutations if the items were unique</p>
<p>There are <em>3! = 6</em> repeating combinations of the letter P</p>
<p>There are <em>2! = 2</em> repeating combinations of the letter E</p>
<p>There are <em>3!2! = 12</em> combinations of P and E duplicates</p>
<p>The number of unique orderings is <em>6! / 3!2! = 6x5x4 / 2x1 = 60</em> unique orderings</p>
</section>
<section id="permuted-groups" class="level4">
<h4 class="anchored" data-anchor-id="permuted-groups">Permuted groups</h4>
<p>How many groups of three can be chosen from a set of five?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>pg <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">num=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">A =</span> <span class="fu">c</span>(<span class="st">"abc"</span>,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"abd"</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"abe"</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"acb"</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"acd"</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"ace"</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"adb"</span>,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"adc"</span>,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"ade"</span>,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"aeb"</span>,</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"aec"</span>,</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"aed"</span>),</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">B=</span><span class="cn">NA</span>, <span class="at">C=</span><span class="cn">NA</span>, <span class="at">D=</span><span class="cn">NA</span>, <span class="at">E=</span><span class="cn">NA</span>)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(pg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-38e041dc{}.cl-38d61c48{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-38d9c55a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-38d9c56e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-38d9d98c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-38d9d996{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-38d9d9a0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-38d9d9a1{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-38d9d9a2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-38d9d9aa{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-38e041dc"><thead><tr style="overflow-wrap:break-word;"><th class="cl-38d9d98c"><p class="cl-38d9c55a"><span class="cl-38d61c48">num</span></p></th><th class="cl-38d9d996"><p class="cl-38d9c56e"><span class="cl-38d61c48">A</span></p></th><th class="cl-38d9d98c"><p class="cl-38d9c55a"><span class="cl-38d61c48">B</span></p></th><th class="cl-38d9d98c"><p class="cl-38d9c55a"><span class="cl-38d61c48">C</span></p></th><th class="cl-38d9d98c"><p class="cl-38d9c55a"><span class="cl-38d61c48">D</span></p></th><th class="cl-38d9d98c"><p class="cl-38d9c55a"><span class="cl-38d61c48">E</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48">1</span></p></td><td class="cl-38d9d9a1"><p class="cl-38d9c56e"><span class="cl-38d61c48">abc</span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48">2</span></p></td><td class="cl-38d9d9a1"><p class="cl-38d9c56e"><span class="cl-38d61c48">abd</span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48">3</span></p></td><td class="cl-38d9d9a1"><p class="cl-38d9c56e"><span class="cl-38d61c48">abe</span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48">4</span></p></td><td class="cl-38d9d9a1"><p class="cl-38d9c56e"><span class="cl-38d61c48">acb</span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48">5</span></p></td><td class="cl-38d9d9a1"><p class="cl-38d9c56e"><span class="cl-38d61c48">acd</span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48">6</span></p></td><td class="cl-38d9d9a1"><p class="cl-38d9c56e"><span class="cl-38d61c48">ace</span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48">7</span></p></td><td class="cl-38d9d9a1"><p class="cl-38d9c56e"><span class="cl-38d61c48">adb</span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48">8</span></p></td><td class="cl-38d9d9a1"><p class="cl-38d9c56e"><span class="cl-38d61c48">adc</span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48">9</span></p></td><td class="cl-38d9d9a1"><p class="cl-38d9c56e"><span class="cl-38d61c48">ade</span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48">10</span></p></td><td class="cl-38d9d9a1"><p class="cl-38d9c56e"><span class="cl-38d61c48">aeb</span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48">11</span></p></td><td class="cl-38d9d9a1"><p class="cl-38d9c56e"><span class="cl-38d61c48">aec</span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a0"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-38d9d9a2"><p class="cl-38d9c55a"><span class="cl-38d61c48">12</span></p></td><td class="cl-38d9d9aa"><p class="cl-38d9c56e"><span class="cl-38d61c48">aed</span></p></td><td class="cl-38d9d9a2"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a2"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a2"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td><td class="cl-38d9d9a2"><p class="cl-38d9c55a"><span class="cl-38d61c48"></span></p></td></tr></tbody></table></div>
</div>
</div>
<p>There are <em>12x5=60</em> possible groups of three</p>
<p>Another derivation would be to say that there are five possibilities for the first letter, four possibilities for the second letter, and three possibilities for the third letter.</p>
<p><em>5x4x3=60</em> possible groups of three</p>
<p>This can be generalized as <span class="math inline">\(P(N, K) = \frac{N!}{ (N-K)!}\)</span></p>
<p>Using the example, <span class="math inline">\(P(N,K)=\frac{5!}{(5-3!)}=60\)</span> possible groups of three</p>
</section>
</section>
<section id="combinations" class="level3">
<h3 class="anchored" data-anchor-id="combinations">Combinations</h3>
<p>Continuing the example above, how many groups of three items from a set of five can we select, where the ordering does not matter? We would express this as choose three from five, or choose <em>K</em> from <em>N</em>, which is written as <span class="math inline">\(\binom{N}{K}\)</span>.</p>
<p>If ordering does not matter, then the groups <em>a,b,c</em> and <em>a,c,b</em> would be considered duplicates. Each group can be ordered in <em>K!</em> ways and these would be duplicates. That leaves us with:</p>
<p><span class="math inline">\(\binom{N}{K}=\frac{P(N,K)}{K!}\)</span></p>
<p>Which is more commonly written after substituting in the expression for <em>P(N,K)</em>:</p>
<p><span class="math inline">\(\binom{N}{K}=\frac{N!}{(N-K)!K!}\)</span></p>
<p>You could also do a brute force example:</p>
<p>How many groups of three can be formed from the letters a, b, c, d?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">include_graphics</span>(<span class="st">"comb2.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="comb2.png" class="img-fluid" width="265"></p>
</div>
</div>
<p>There are <em>4!=24</em> possible permutations</p>
<p>If ordering does not matter, then there are <span class="math inline">\(P(N,K)=\frac{N!}{ (N-K)!}=\frac{4!}{(2-2)!}=12\)</span> possible groups of two to be selected from a set of four.</p>
<p>If ordering does matter, then there are <span class="math inline">\(\binom{N}{K}=\frac{P(N,K)}{K!}=\frac{N!}{(N-K)!K!}=\frac{4!}{(4-2)!2!}=6\)</span></p>
</section>
<section id="randomization-inference" class="level3">
<h3 class="anchored" data-anchor-id="randomization-inference">Randomization inference</h3>
<p>Permutations may be used to generate test statistics.</p>
</section>
</section>
<section id="homework" class="level2">
<h2 class="anchored" data-anchor-id="homework">Homework</h2>
<ol type="1">
<li><p>Suppose the globe tossing data had turned out to be 3 water and 11 land. Construct the posterior distribution.</p>
<p>Slide 50 starts coding the estimator using the example of a single sample of 6 waters and 3 lands.</p>
<p>Slide 53 provides a function to simulate a set of globe tosses of any probability and number of tosses.</p>
<p>Slide 59 provides a function to compute the posterior, that includes the simulation function as an argument.</p>
<p>Slide 90 simulates the posterior predictive distribution</p>
<p>In reviewing this code, note that the simulation will give you a probabilistic response, while the homework establishes an exact sample of 3 water and 11 land. Let’s modify the code on slide 59 to accept this exact sample.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>compute_posterior <span class="ot">&lt;-</span> <span class="cf">function</span>(W, L,</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">poss=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">len=</span><span class="dv">11</span>)) {</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  ways <span class="ot">&lt;-</span> <span class="fu">sapply</span>(poss, <span class="cf">function</span>(q) (q<span class="sc">*</span><span class="dv">4</span>)<span class="sc">^</span>W <span class="sc">*</span> (<span class="dv">4-4</span><span class="sc">*</span>q)<span class="sc">^</span>L)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  post <span class="ot">&lt;-</span> ways<span class="sc">/</span><span class="fu">sum</span>(ways)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  bars <span class="ot">&lt;-</span> <span class="fu">sapply</span>(post, <span class="cf">function</span>(q) <span class="fu">make_bar</span>(q))</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(poss, ways, post, bars)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">compute_posterior</span>(<span class="at">W=</span><span class="dv">3</span>,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">L=</span><span class="dv">11</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-3907db0c{}.cl-38fd1834{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-39019cf6{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-39019d0a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-3901b830{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3901b83a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3901b83b{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3901b844{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3901b845{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3901b84e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-3907db0c"><thead><tr style="overflow-wrap:break-word;"><th class="cl-3901b830"><p class="cl-39019cf6"><span class="cl-38fd1834">poss</span></p></th><th class="cl-3901b830"><p class="cl-39019cf6"><span class="cl-38fd1834">ways</span></p></th><th class="cl-3901b830"><p class="cl-39019cf6"><span class="cl-38fd1834">post</span></p></th><th class="cl-3901b83a"><p class="cl-39019d0a"><span class="cl-38fd1834">bars</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">0.0</span></p></td><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">0.00000</span></p></td><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">0.00000000000</span></p></td><td class="cl-3901b844"><p class="cl-39019d0a"><span class="cl-38fd1834">                    </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">0.1</span></p></td><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">84,237.89046</span></p></td><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">0.17075463813</span></p></td><td class="cl-3901b844"><p class="cl-39019d0a"><span class="cl-38fd1834">###                 </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">0.2</span></p></td><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">184,467.44074</span></p></td><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">0.37392521248</span></p></td><td class="cl-3901b844"><p class="cl-39019d0a"><span class="cl-38fd1834">#######             </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">0.3</span></p></td><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">143,311.84360</span></p></td><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">0.29050065071</span></p></td><td class="cl-3901b844"><p class="cl-39019d0a"><span class="cl-38fd1834">######              </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">0.4</span></p></td><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">62,328.05962</span></p></td><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">0.12634225772</span></p></td><td class="cl-3901b844"><p class="cl-39019d0a"><span class="cl-38fd1834">###                 </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">0.5</span></p></td><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">16,384.00000</span></p></td><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">0.03321123043</span></p></td><td class="cl-3901b844"><p class="cl-39019d0a"><span class="cl-38fd1834">#                   </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">0.6</span></p></td><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">2,431.94380</span></p></td><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">0.00492967809</span></p></td><td class="cl-3901b844"><p class="cl-39019d0a"><span class="cl-38fd1834">                    </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">0.7</span></p></td><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">163.10520</span></p></td><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">0.00033062282</span></p></td><td class="cl-3901b844"><p class="cl-39019d0a"><span class="cl-38fd1834">                    </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">0.8</span></p></td><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">2.81475</span></p></td><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">0.00000570565</span></p></td><td class="cl-3901b844"><p class="cl-39019d0a"><span class="cl-38fd1834">                    </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">0.9</span></p></td><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">0.00196</span></p></td><td class="cl-3901b83b"><p class="cl-39019cf6"><span class="cl-38fd1834">0.00000000397</span></p></td><td class="cl-3901b844"><p class="cl-39019d0a"><span class="cl-38fd1834">                    </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3901b845"><p class="cl-39019cf6"><span class="cl-38fd1834">1.0</span></p></td><td class="cl-3901b845"><p class="cl-39019cf6"><span class="cl-38fd1834">0.00000</span></p></td><td class="cl-3901b845"><p class="cl-39019cf6"><span class="cl-38fd1834">0.00000000000</span></p></td><td class="cl-3901b84e"><p class="cl-39019d0a"><span class="cl-38fd1834">                    </span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Just like the example above, plot the posterior distribution</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(out, <span class="fu">aes</span>(<span class="at">x=</span>poss)) <span class="sc">+</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">y=</span>post),</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">width=</span>.<span class="dv">05</span>,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">color=</span><span class="st">"blue"</span>,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill=</span><span class="st">"dodgerblue2"</span>,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha=</span>.<span class="dv">6</span>) <span class="sc">+</span> </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_col(aes(y=prior),</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#          width=.05,</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#          color="green",</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#          fill="lightgreen",</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#          alpha=.6) + </span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">1</span>),</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">percent_format</span>(<span class="at">accuracy=</span><span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">21</span>),</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,.<span class="dv">2</span>,.<span class="dv">05</span>),</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">percent_format</span>(<span class="at">accuracy=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Candidate model value"</span>,</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Probability"</span>,</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Posterior distribution"</span>) <span class="sc">+</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">0</span>, <span class="at">vjust=</span>.<span class="dv">55</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values (`position_stack()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="rethinking2024wk1_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div></li>
<li><p>Using the posterior distribution from 1, compute the posterior predictive distribution for the next 5 tosses of the same globe. Use the sampling method.</p>
<p>The posterior predictive distribution is an extraction of data - a simulation - using the probabilities of the posterior distribution. We then examine that posterior predictive distribution to make descriptive statements about our questions of interest.</p>
<p>Recall that we have a sample of 3 land and 11 water. Slide 90 shows how to draw probabilities from the posterior.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>post_samples <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="fl">1e4</span>, <span class="dv">3</span><span class="sc">+</span><span class="dv">1</span>, <span class="dv">11</span><span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x=</span>post_samples), <span class="fu">aes</span>(x)) <span class="sc">+</span> </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(<span class="fu">mean</span>(post_samples), <span class="fu">median</span>(post_samples)), <span class="at">color=</span><span class="fu">c</span>(<span class="st">"darkgoldenrod2"</span>, <span class="st">"green"</span>),</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color=</span><span class="st">"blue"</span>,</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">"dodgerblue2"</span>,</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">size=</span>.<span class="dv">8</span>,</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha=</span>.<span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">1</span>),</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">percent_format</span>(<span class="at">accuracy=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y=</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Posterior predictive distribution"</span>,</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Probability of water"</span>,</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">""</span>,</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">"Probability of water 3/14 = 21.4%"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="rethinking2024wk1_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now that we have our posterior predictive distribution, we can predict the probability of any <em>p</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>W_sim <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="at">size=</span><span class="dv">5</span>, <span class="at">p=</span>post_samples)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x=</span>W_sim), <span class="fu">aes</span>(x)) <span class="sc">+</span> </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">width=</span>.<span class="dv">4</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">color=</span><span class="st">"blue"</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill=</span><span class="st">"dodgerblue2"</span>,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha=</span>.<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y=</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Counts of water"</span>,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">""</span>,</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Posterior predictive distribution</span><span class="sc">\n</span><span class="st">for five additional coin tosses"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="rethinking2024wk1_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Consistent with an expected probability of 11 percent, the most likely outcome of five tosses is 1 water. Zero outomes of water is the second-most likely outcome of five tosses.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>